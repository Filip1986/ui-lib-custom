:host,
.ui-lib-accordion-panel {
  --uilib-accordion-panel-bg: var(--uilib-surface, #ffffff);
  --uilib-accordion-panel-border: 1px solid var(--uilib-border, #e5e7eb);
  --uilib-accordion-panel-radius: var(--uilib-radius-md, 0.5rem);
  --uilib-accordion-header-padding-sm: var(--uilib-space-3, 0.75rem);
  --uilib-accordion-header-padding-md: var(--uilib-space-4, 1rem);
  --uilib-accordion-header-padding-lg: var(--uilib-space-5, 1.25rem);
  --uilib-accordion-header-padding: var(
    --uilib-accordion-header-padding-md,
    var(--uilib-space-4, 1rem)
  );
  --uilib-accordion-header-bg: var(--uilib-surface, transparent);
  --uilib-accordion-header-bg-hover: var(
    --uilib-surface-hover,
    color-mix(in srgb, currentColor 6%, transparent)
  );
  --uilib-accordion-header-color: var(--uilib-page-fg, #111827);
  --uilib-accordion-header-font-weight: var(--uilib-font-weight-500, 500);
  --uilib-accordion-content-padding: var(--uilib-space-4, 1rem);
  --uilib-accordion-content-bg: var(--uilib-surface, #ffffff);
  --uilib-accordion-icon-size-sm: var(--uilib-icon-size-sm, 1rem);
  --uilib-accordion-icon-size-md: var(--uilib-icon-size-md, 1.25rem);
  --uilib-accordion-icon-size-lg: var(--uilib-icon-size-lg, 1.5rem);
  --uilib-accordion-icon-size: var(
    --uilib-accordion-icon-size-md,
    var(--uilib-icon-size-md, 1.25rem)
  );
  --uilib-accordion-icon-color: var(--uilib-muted, #6b7280);
  --uilib-accordion-icon-color-hover: var(--uilib-primary, #2563eb);
  --uilib-accordion-icon-color-expanded: var(--uilib-primary, #2563eb);
  --uilib-accordion-icon-rotation: var(--uilib-rotation-0, 0deg);
  --uilib-accordion-icon-transition: transform var(--uilib-transition-fast, 200ms ease);
  --uilib-accordion-focus-ring: 0 0 0 2px var(--uilib-focus-ring-color, #2563eb55);
  --uilib-accordion-transition-duration: var(--uilib-transition-fast-duration, 200ms);
  --uilib-accordion-transition-easing: var(--uilib-transition-ease-out, ease-out);
  --uilib-accordion-icon-gap: var(--uilib-space-2, 0.5rem);
  --uilib-accordion-icon-align: center;
}

.ui-lib-accordion-panel {
  background: var(--uilib-accordion-panel-bg);
  border: var(--uilib-accordion-panel-border);
  border-radius: var(--uilib-accordion-panel-radius);
  overflow: hidden;
  display: block;

  &.accordion-panel-disabled {
    opacity: 0.6;
    pointer-events: none;
  }

  .accordion-panel-header {
    display: flex;
    align-items: center;
    gap: var(--uilib-accordion-icon-gap);
    width: 100%;
    padding: var(--uilib-accordion-header-padding);
    background: var(--uilib-accordion-header-bg);
    color: var(--uilib-accordion-header-color);
    font-weight: var(--uilib-accordion-header-font-weight);
    cursor: pointer;
    border: none;
    outline: none;

    &:hover {
      background: var(--uilib-accordion-header-bg-hover);

      .accordion-panel-icon {
        color: var(--uilib-accordion-icon-color-hover);
      }
    }

    &:focus-visible {
      box-shadow: var(--uilib-accordion-focus-ring);
    }

    .accordion-panel-title {
      flex: 1 1 auto;
      order: 1;
    }

    .accordion-panel-icon {
      width: var(--uilib-accordion-icon-size);
      height: var(--uilib-accordion-icon-size);
      color: var(--uilib-accordion-icon-color);
      align-self: var(--uilib-accordion-icon-align);
      transition: color var(--uilib-transition-fast, 200ms ease),
        opacity var(--uilib-transition-fast, 200ms ease),
        transform var(--uilib-transition-fast, 200ms ease);
      display: inline-flex;
      align-items: center;
      justify-content: center;

      &.icon-start {
        order: 0;
        margin-right: var(--uilib-accordion-icon-gap);
      }

      &.icon-end {
        order: 2;
        margin-left: auto;
      }

      &.expanded {
        color: var(--uilib-accordion-icon-color-expanded);
        transform: rotate(var(--uilib-accordion-icon-rotation));
      }
    }
  }

  .accordion-panel-content {
    background: var(--uilib-accordion-content-bg);
    display: grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows var(--uilib-accordion-transition-duration)
      var(--uilib-accordion-transition-easing);

    &.expanded {
      grid-template-rows: 1fr;
    }

    > .accordion-panel-body {
      overflow: hidden;
      padding: var(--uilib-accordion-content-padding);
    }
  }
}

/* Material */
.ui-lib-accordion.accordion-variant-material {
  .ui-lib-accordion-panel {
    box-shadow: var(--uilib-card-shadow, var(--uilib-shadow-md, none));
    transition: box-shadow var(--uilib-transition-fast, 150ms ease),
      transform var(--uilib-transition-fast, 150ms ease);
    border: none;

    &:hover {
      box-shadow: var(--uilib-shadow-lg, var(--uilib-card-shadow-hover, var(--uilib-shadow-lg, none)));
    }
  }
}

/* Bootstrap */
.ui-lib-accordion.accordion-variant-bootstrap {
  .ui-lib-accordion-panel {
    border-radius: 0;
    border-left: var(--uilib-accordion-panel-border);
    border-right: var(--uilib-accordion-panel-border);

    &:first-child {
      border-top: var(--uilib-accordion-panel-border);
      border-top-left-radius: var(--uilib-accordion-border-radius);
      border-top-right-radius: var(--uilib-accordion-border-radius);
    }

    &:last-child {
      border-bottom: var(--uilib-accordion-panel-border);
      border-bottom-left-radius: var(--uilib-accordion-border-radius);
      border-bottom-right-radius: var(--uilib-accordion-border-radius);
    }

    .accordion-panel-header:hover {
      background: var(--uilib-surface-hover, color-mix(in srgb, currentColor 6%, transparent));
    }
  }
}

/* Minimal */
.ui-lib-accordion.accordion-variant-minimal {
  .ui-lib-accordion-panel {
    background: transparent;
    border: none;
    box-shadow: none;

    .accordion-panel-header {
      background: transparent;
      border-bottom: 1px solid var(--uilib-border-subtle, #e5e7eb);

      &:hover {
        background: var(--uilib-surface-subtle, color-mix(in srgb, currentColor 4%, transparent));
      }
    }

    .accordion-panel-content {
      border-bottom: 1px solid var(--uilib-border-subtle, #e5e7eb);
    }

    &:last-child .accordion-panel-content {
      border-bottom: none;
    }
  }
}

@media (prefers-reduced-motion: reduce) {
  .ui-lib-accordion-panel {
    .accordion-panel-content {
      transition: none;
    }

    .accordion-panel-header .accordion-panel-icon {
      transition: none;
    }
  }
}
