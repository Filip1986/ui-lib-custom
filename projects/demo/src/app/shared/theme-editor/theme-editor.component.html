<div class="theme-toggle" (click)="onTogglePanel()" title="Toggle Theme Editor">
  ⚙
</div>

<div class="theme-panel" [class.theme-panel--open]="showPanel()">
  <div class="theme-panel__header">
    <div>
      <div class="title">Theme Editor</div>
      <div class="subtitle">Live tweak and export</div>
    </div>
    <button class="ghost" (click)="onTogglePanel()" aria-label="Close editor">✕</button>
  </div>

  <div class="section">
    <label class="label">Preset</label>
    <select [ngModel]="currentPreset().name" (ngModelChange)="onPresetChange($event)">
      @for (name of presetNames(); track name) {
        <option [value]="name">{{ name }}</option>
      }
    </select>
  </div>

  <div class="section grid">
    <div class="label full">Colors</div>
    @for (key of colorKeys; track key) {
      <label class="color-field">
        <span class="label">{{ key | titlecase }}</span>
        <input type="color" [ngModel]="currentPreset().colors[key]" (ngModelChange)="onColorChange(key, $event)">
      </label>
    }
  </div>

  <div class="section">
    <label class="label">Border radius</label>
    <select [ngModel]="currentPreset().shape.borderRadius" (ngModelChange)="onRadiusChange($event)">
      @for (opt of radiusOptions; track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>
  </div>

  <div class="section">
    <label class="label">Variant</label>
    <div class="radio-group">
      @for (opt of variantOptions; track opt.value) {
        <label class="radio">
          <input type="radio" name="variant" [value]="opt.value" [checked]="currentPreset().variant === opt.value" (change)="onVariantChange(opt.value)">
          <span>{{ opt.label }}</span>
        </label>
      }
    </div>
  </div>

  <div class="section">
    <div class="label">Typography</div>
    <label class="sub-label">Suggested pairings</label>
    <select [ngModel]="selectedPairing()" (ngModelChange)="onPairingSelect($event)">
      <option value="">-- Select pairing --</option>
      @for (pair of pairingOptions(); track pair.name) {
        <option [value]="pair.name">{{ pair.name }} ({{ pair.description || pair.category }})</option>
      }
    </select>

    <label class="sub-label">Heading font</label>
    <select [ngModel]="headingFont()" (ngModelChange)="onHeadingFontChange($event)">
      @for (opt of headingFontOptions(); track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>

    <label class="sub-label">Body font</label>
    <select [ngModel]="bodyFont()" (ngModelChange)="onBodyFontChange($event)">
      @for (opt of bodyFontOptions(); track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>

    <label class="sub-label">UI font</label>
    <div class="inline">
      <select [ngModel]="uiFont()" [disabled]="syncUIWithBody()" (ngModelChange)="onUIFontChange($event)">
        @for (opt of uiFontOptions(); track opt.value) {
          <option [value]="opt.value">{{ opt.label }}</option>
        }
      </select>
      <label class="inline-toggle">
        <input type="checkbox" [checked]="syncUIWithBody()" (change)="onSyncUIToggle($any($event.target).checked)">
        Sync UI with Body
      </label>
    </div>

    <label class="sub-label">Code font</label>
    <select [ngModel]="monoFont()" (ngModelChange)="onMonoFontChange($event)">
      @for (opt of monoFontOptions(); track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>
  </div>

  <div class="section">
    <label class="label">Base font size: {{ currentPreset().typography.baseFontSize }}</label>
    <input type="range" min="12" max="20" step="1" [ngModel]="currentPreset().typography.baseFontSize.replace('px','')" (ngModelChange)="onBaseSizeChange($event)">
  </div>

  <div class="section">
    <label class="label">Shadow</label>
    <select [ngModel]="currentPreset().shadow || shadowOptions[0]?.value" (ngModelChange)="onShadowChange($event)">
      @for (opt of shadowOptions; track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>
  </div>

  <div class="section">
    <label class="label">Card shadow</label>
    <select [ngModel]="currentPreset().cardShadow || currentPreset().shadow || shadowOptions[0]?.value" (change)="onCardShadowPreview($any($event.target).value)" (ngModelChange)="onCardShadowChange($event)">
      @for (opt of shadowOptions; track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>
  </div>

  <div class="section">
    <label class="label">Button shadow</label>
    <select [ngModel]="currentPreset().buttonShadow || currentPreset().shadow || shadowOptions[0]?.value" (change)="onButtonShadowPreview($any($event.target).value)" (ngModelChange)="onButtonShadowChange($event)">
      @for (opt of shadowOptions; track opt.value) {
        <option [value]="opt.value">{{ opt.label }}</option>
      }
    </select>
  </div>

  <div class="section">
    <ui-lib-icon-editor-panel />
  </div>

  <div class="section">
    <ui-lib-icon-preview />
  </div>

  <div class="actions">
    <button class="primary" (click)="exportTheme()">Export Theme</button>
    <button class="ghost" (click)="resetToDefault()">Reset to Default</button>
  </div>
</div>
